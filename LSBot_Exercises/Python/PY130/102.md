# PY130 - Closures, Decorators & Partial Functions
## Problem 102: Decorator Stacking

What happens when you stack multiple decorators on a single function? Explain the order of execution and provide an example.

<details>
<summary>Solution:</summary>

Decorators are first applied from bottoms up but they are excecuted from top down.

```python
def upper_deco(func):
    def wrapper(*args, **kwargs):
        print("I'm going to uppercase.")
        result = func(*args, **kwargs).upper()
        return result
    return wrapper

def emphasize_deco(func):
    def wrapper(*args, **kwargs):
        print("I'm going to emphasize.")
        result = f"**{func(*args, **kwargs)}**"
        return result
    return wrapper

@upper_deco
@emphasize_deco
def greet(name):
    return f"My name is {name}."

print(greet("Maple"))
'''
I'm going to uppercase.
I'm going to emphasize.
**MY NAME IS MAPLE.**
'''

```
Applying the decorators binds `greet` to `upper_deco(emphasize_deco(greet))`. The original `greet` function is passed to `emphasize_deco`, which returns a new function (its wrapper). That new function is then immediately passed to `upper_deco`, which returns yet another new function (its own wrapper).

Step by step;
1.  The call to `greet("Maple")` invokes the wrapper function returned by `upper_deco`.
2.  Inside upper_deco's wrapper, `print("I'm going to uppercase.")` is executed.
3.  The next line calls `func("Maple")`. The func here is the wrapper function returned by emphasize_deco.
4.  Execution moves to `emphasize_deco`'s wrapper. `print("I'm going to emphasize.")` is executed.
5.  The next line calls `func("Maple")`. The func at this level is the original, undecorated greet function.
6.  The original `greet("Maple")` is executed and returns "My name is Maple.".
7.  Control returns to emphasize_deco's wrapper, which receives "My name is Maple.", modifies it to "**My name is Maple.**", and returns it.
8.  Control returns to `upper_deco`'s wrapper, which receives "**My name is Maple.**", calls `.upper()` on it to get "**MY NAME IS MAPLE.**", and returns that final result.
9.  `print()` outputs the final returned value.

</details>

---

[Previous](101.md) | [Next](103.md)