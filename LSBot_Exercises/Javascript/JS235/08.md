# JS235
## Problem 8: Debugging Event Listener

This code is intended to change the background color of a list item when it's clicked. However, when any li is clicked, it throws an error (TypeError: Cannot set properties of undefined). Why is this happening and how can it be fixed?

## Examples:

```html
<ul id="name-list">
  <li>Alpha</li>
  <li>Bravo</li>
  <li>Charlie</li>
</ul>
<script>
  const listItems = document.querySelectorAll('#name-list li');
  for (var i = 0; i < listItems.length; i++) {
    listItems[i].addEventListener('click', function() {
      // The error occurs on the next line
      listItems[i].style.backgroundColor = 'lightblue';
    });
  }
</script>
```

<details>
<summary>Solution:</summary>

The problem is caused by the use of `var` in the for loop. The `i` variable is function-scoped. By the time any click event handler is executed, the loop has already completed, and the value of `i` is 3 (the final value that caused the loop to terminate). Since `listItems[3]` is undefined, trying to access its style property throws a TypeError.

The easiest fix is to use `let` instead of `var`. `let` is block-scoped, so each loop iteration gets its own unique `i` variable that is "closed over" by the event handler.

```javascript
const listItems = document.querySelectorAll('#name-list li');
// Using let creates a new `i` for each iteration.
for (let i = 0; i < listItems.length; i++) {
  listItems[i].addEventListener('click', function() {
    listItems[i].style.backgroundColor = 'lightblue';
  });
}
```

**Alternative (Better) Solution using Event Delegation:**

```javascript
document.getElementById('name-list').addEventListener('click', (event) => {
  if (event.target.tagName === 'LI') {
    event.target.style.backgroundColor = 'lightblue';
  }
});
```

</details>

---

[Previous](07.md) | [Next](09.md)