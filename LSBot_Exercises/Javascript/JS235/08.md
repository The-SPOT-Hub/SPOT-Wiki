<p align="right">
  <a id="spot-launch-btn" class="spot-editor-link" href="https://launchschool.com/the-spot?url=https://github.com/The-SPOT-Hub/SPOT-Wiki/blob/main/LSBot_Exercises/Javascript/JS235/08.md" target="_blank">
  <img src="https://img.shields.io/badge/Work%20in%20LS%20Code%20Editor-555?style=flat&logo=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZyBmaWxsPSIjZjM1YjVhIj48cGF0aCBkPSJNOTgsMS45Yy0yLjUtMi41LTYuNi0yLjUtOS4xLDBMMjcuMiw2My43Yy0yLjUsMi41LTIuNSw2LjYsMCw5LjFjMi41LDIuNSw2LjYsMi41LDkuMSwwTDk4LDExLjFDMTAwLjYsOC41LDEwMC41LDQuNSw5OCwxLjl6Ii8%2BPHBhdGggZD0iTTg4LjksNzQuOWwtMTQsMTRjLTIuNSwyLjUtMi41LDYuNiwwLDkuMWMyLjUsMi41LDYuNiwyLjUsOS4xLDBsMTQtMTRjMi41LTIuNSwyLjUtNi42LDAtOS4xQzk1LjUsNzIuNCw5MS40LDcyLjQsODguOSw3NC45eiIvPjxwYXRoIGQ9Ik05OC4xLDM4LjRjLTIuNS0yLjUtNi42LTIuNS05LjEsMEw2Mi43LDY0LjZjLTIuNSwyLjUtMi41LDYuNiwwLDkuMWMyLjUsMi41LDYuNiwyLjUsOS4xLDBsMjYuMy0yNi4zQzEwMC42LDQ1LDEwMC42LDQwLjksOTguMSwzOC40eiIvPjxwYXRoIGQ9Ik0yNSwyYy0yLjUtMi41LTYuNi0yLjUtOS4xLDBsLTE0LDE0Yy0yLjUsMi41LTIuNSw2LjYsMCw5LjFjMi41LDIuNSw2LjYsMi41LDkuMSwwbDE0LTE0QzI3LjYsOC42LDI3LjYsNC41LDI1LDJ6Ii8%2BPHBhdGggZD0iTTM1LjQsMzcuM0w2MS42LDExYzIuNS0yLjUsMi41LTYuNiwwLTkuMWMtMi41LTIuNS02LjYtMi41LTkuMSwwTDI2LjIsMjguMmMtMi41LDIuNS0yLjUsNi42LDAsOS4xQzI4LjgsMzkuOCwzMi44LDM5LjgsMzUuNCwzNy4zeiIvPjwvZz48L3N2Zz4%3D" alt="Work in LS Code Editor">
</a>
</p>

# JS235
## Problem 8: Debugging Event Listener

This code is intended to change the background color of a list item when it's clicked. However, when any li is clicked, it throws an error (TypeError: Cannot set properties of undefined). Why is this happening and how can it be fixed?

## Examples:

```html
<ul id="name-list">
  <li>Alpha</li>
  <li>Bravo</li>
  <li>Charlie</li>
</ul>
<script>
  const listItems = document.querySelectorAll('#name-list li');
  for (var i = 0; i < listItems.length; i++) {
    listItems[i].addEventListener('click', function() {
      // The error occurs on the next line
      listItems[i].style.backgroundColor = 'lightblue';
    });
  }
</script>
```

<details>
<summary>Solution:</summary>

The problem is caused by the use of `var` in the for loop. The `i` variable is function-scoped. By the time any click event handler is executed, the loop has already completed, and the value of `i` is 3 (the final value that caused the loop to terminate). Since `listItems[3]` is undefined, trying to access its style property throws a TypeError.

The easiest fix is to use `let` instead of `var`. `let` is block-scoped, so each loop iteration gets its own unique `i` variable that is "closed over" by the event handler.

```javascript
const listItems = document.querySelectorAll('#name-list li');
// Using let creates a new `i` for each iteration.
for (let i = 0; i < listItems.length; i++) {
  listItems[i].addEventListener('click', function() {
    listItems[i].style.backgroundColor = 'lightblue';
  });
}
```

**Alternative (Better) Solution using Event Delegation:**

```javascript
document.getElementById('name-list').addEventListener('click', (event) => {
  if (event.target.tagName === 'LI') {
    event.target.style.backgroundColor = 'lightblue';
  }
});
```

</details>

---

[Previous](07.md) | [Next](09.md)