# JS101
## Problem 57: Complex Precedence

What will be the output of the following code? Explain the steps taken.

```js
function foo() {
  console.log("foo was called");
  return false;
}

function bar() {
  console.log("bar was called");
  return true;
}

let result = foo() ? foo() : bar() || foo() ? foo() : bar();
```

### Bonus Questions
1. What does `result` reference at the end of this snippet?
2. How does our answer change if we replace the `||` with `&&`?
3. Do you think the expression on line 11 would be more readable with parentheses? If so, where?

<details>
<summary>Solution:</summary>

**Output:**
```
foo was called
bar was called
foo was called
```

**Explanation:**

Both `||` and `&&` have higher precedence than the ternary operator (`?:`), so this is grouped as:
```js
foo() ? foo() : ((bar() || foo()) ? foo() : bar())
```

Step by step:
1. First `foo()` is called → logs "foo was called", returns `false`
2. Since the condition is `false`, we evaluate the right side: `(bar() || foo()) ? foo() : bar()`
3. First, we need to evaluate the condition: `bar() || foo()`
4. `bar()` is called → logs "bar was called", returns `true`
5. Since `||` short-circuits on truthy, the `foo()` in `bar() || foo()` is NOT called
6. The condition `bar() || foo()` evaluates to `true`
7. Now we have `true ? foo() : bar()`
8. Since the condition is `true`, we call `foo()` → logs "foo was called", returns `false`
9. `result = false`

**Bonus Questions:**

1. `result` references `false` (the return value of the final `foo()` call).

2. If we replace `||` with `&&`:
```js
foo() ? foo() : bar() && foo() ? foo() : bar()
// Groups as: foo() ? foo() : ((bar() && foo()) ? foo() : bar())
```
Step by step:
- First `foo()` → "foo was called", returns `false`
- Goes to right side: `(bar() && foo()) ? foo() : bar()`
- Need to evaluate condition `bar() && foo()`
- `bar()` → "bar was called", returns `true`  
- `&&` doesn't short-circuit on truthy, so `foo()` is called → "foo was called", returns `false`
- Condition `bar() && foo()` evaluates to `false`
- Since condition is false: `false ? foo() : bar()`
- We call `bar()` → "bar was called", returns `true`
- `result = true`
- Output would be:
```
foo was called
bar was called
foo was called
bar was called
```

3. Yes! Parentheses would make this much more readable:
```js
foo() ? foo() : ((bar() || foo()) ? foo() : bar())
```
This makes it clear that we have a nested ternary, where the false branch of the first ternary is itself another ternary expression with `bar() || foo()` as its condition.

</details>

---

[Previous](56.md) | [Next](58.md)

